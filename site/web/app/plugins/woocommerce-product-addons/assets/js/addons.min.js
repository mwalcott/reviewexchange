jQuery(document).ready(function(a){a.fn.init_addon_totals=function(){var o=a(this);a(this).on("click",".reset_variations",function(){a.each(o.find(".product-addon"),function(){var o=a(this).find(".addon");(o.is(":checkbox")||o.is(":radio"))&&o.prop("checked",!1),o.is("select")&&o.prop("selectedIndex",0),(o.is(":text")||o.is("textarea")||o.is('input[type="number"]')||o.is('input[type="file"]'))&&o.val("")}),o.trigger("woocommerce-product-addons-update")}),a(this).on("keyup change",".product-addon input, .product-addon textarea",function(){if(a(this).attr("maxlength")>0){var o=a(this).val(),r=a(this).attr("maxlength")-o.length;a(this).next(".chars_remaining").find("span").text(r)}}),a(this).find(" .addon-custom, .addon-custom-textarea").each(function(){a(this).attr("maxlength")>0&&a(this).after('<small class="chars_remaining"><span>'+a(this).attr("maxlength")+"</span> "+woocommerce_addons_params.i18n_remaining+"</small>")}),a(this).on("change",".product-addon input, .product-addon textarea, .product-addon select, input.qty",function(){a(this).trigger("woocommerce-product-addons-update")}),a(this).on("found_variation",function(o,r){var t=a(this),d=t.find("#product-addons-total");"undefined"!=typeof r.display_price?d.data("price",r.display_price):a(r.price_html).find(".amount:last").size()&&(product_price=a(r.price_html).find(".amount:last").text(),product_price=product_price.replace(woocommerce_addons_params.currency_format_symbol,""),product_price=product_price.replace(woocommerce_addons_params.currency_format_thousand_sep,""),product_price=product_price.replace(woocommerce_addons_params.currency_format_decimal_sep,"."),product_price=product_price.replace(/[^0-9\.]/g,""),product_price=parseFloat(product_price),d.data("price",product_price)),t.trigger("woocommerce-product-addons-update")}),a(this).on("woocommerce-product-addons-update",function(){var r=0,t=o.find("#product-addons-total"),d=t.data("price"),e=t.data("type"),c=t.data("product-id"),s=t.data("raw-price"),n=t.data("tax-mode"),i=t.data("tax-display-mode"),m=0;if(("variable"==e||"variable-subscription"==e)&&o.find(".single_variation").after(t),o.find(".addon").each(function(){var o=0,t=0;a(this).is(".addon-custom-price")?o=a(this).val():a(this).is(".addon-input_multiplier")?(isNaN(a(this).val())||""==a(this).val()?(a(this).val(""),a(this).closest("p").find(".addon-alert").show()):(""!=a(this).val()&&a(this).val(Math.ceil(a(this).val())),a(this).closest("p").find(".addon-alert").hide()),o=a(this).data("price")*a(this).val(),t=a(this).data("raw-price")*a(this).val()):a(this).is(".addon-checkbox, .addon-radio")?a(this).is(":checked")&&(o=a(this).data("price"),t=a(this).data("raw-price")):a(this).is(".addon-select")?a(this).val()&&(o=a(this).find("option:selected").data("price"),t=a(this).find("option:selected").data("raw-price")):a(this).val()&&(o=a(this).data("price"),t=a(this).data("raw-price")),o||(o=0),t||(t=0),r=parseFloat(r)+parseFloat(o),m=parseFloat(m)+parseFloat(t)}),t.data("addons-price",r),t.data("addons-raw-price",m),o.find("input.qty").size()){var _=0;o.find("input.qty").each(function(){_+=parseFloat(a(this).val())})}else var _=1;if(r>0&&_>0){var p,l;r=parseFloat(r*_),m=parseFloat(m*_);var u=accounting.formatMoney(r,{symbol:woocommerce_addons_params.currency_format_symbol,decimal:woocommerce_addons_params.currency_format_decimal_sep,thousand:woocommerce_addons_params.currency_format_thousand_sep,precision:woocommerce_addons_params.currency_format_num_decimals,format:woocommerce_addons_params.currency_format});if("undefined"!=typeof d){p=parseFloat(d*_);var f=accounting.formatMoney(p+r,{symbol:woocommerce_addons_params.currency_format_symbol,decimal:woocommerce_addons_params.currency_format_decimal_sep,thousand:woocommerce_addons_params.currency_format_thousand_sep,precision:woocommerce_addons_params.currency_format_num_decimals,format:woocommerce_addons_params.currency_format})}l=parseFloat(s*_);var h=accounting.formatMoney(l+m,{symbol:woocommerce_addons_params.currency_format_symbol,decimal:woocommerce_addons_params.currency_format_decimal_sep,thousand:woocommerce_addons_params.currency_format_thousand_sep,precision:woocommerce_addons_params.currency_format_num_decimals,format:woocommerce_addons_params.currency_format}),g=!1;a(".entry-summary .subscription-details").length&&(g=a(".entry-summary .subscription-details").clone().wrap("<p>").parent().html()),g&&(u+=g,f&&(f+=g));var y='<dl class="product-addon-totals"><dt>'+woocommerce_addons_params.i18n_addon_total+'</dt><dd><strong><span class="amount">'+u+"</span></strong></dd>";if(f&&"1"==t.data("show-grand-total")){var w="";if(!woocommerce_addons_params.price_display_suffix)return y=y+"<dt>"+woocommerce_addons_params.i18n_grand_total+'</dt><dd><strong><span class="amount">'+f+"</span></strong></dd></dl>",t.html(y),void o.trigger("updated_addons");if(!1==woocommerce_addons_params.price_display_suffix.indexOf("{price_including_tax}")>-1&&!1==woocommerce_addons_params.price_display_suffix.indexOf("{price_excluding_tax}")>-1)return y=y+"<dt>"+woocommerce_addons_params.i18n_grand_total+'</dt><dd><strong><span class="amount">'+f+"</span> "+woocommerce_addons_params.price_display_suffix+"</strong></dd></dl>",t.html(y),void o.trigger("updated_addons");if("excl"===n&&"incl"===i)return w='<small class="woocommerce-price-suffix">'+woocommerce_addons_params.price_display_suffix+"</small>",w=w.replace("{price_including_tax}",f),w=w.replace("{price_excluding_tax}",h),y=y+"<dt>"+woocommerce_addons_params.i18n_grand_total+'</dt><dd><strong><span class="amount">'+f+"</span> "+w+" </strong></dd></dl>",t.html(y),void o.trigger("updated_addons");if("incl"===n&&"excl"===i)return w='<small class="woocommerce-price-suffix">'+woocommerce_addons_params.price_display_suffix+"</small>",w=w.replace("{price_including_tax}",h),w=w.replace("{price_excluding_tax}",f),y=y+"<dt>"+woocommerce_addons_params.i18n_grand_total+'</dt><dd><strong><span class="amount">'+f+"</span> "+w+" </strong></dd></dl>",t.html(y),void o.trigger("updated_addons");a.ajax({type:"POST",url:woocommerce_addons_params.ajax_url,data:{action:"wc_product_addons_calculate_tax",total:p+r,product_id:c},success:function(r){if(result=a.parseJSON(r),"SUCCESS"==result.result){w='<small class="woocommerce-price-suffix">'+woocommerce_addons_params.price_display_suffix+"</small>";var d=accounting.formatMoney(result.price_including_tax,{symbol:woocommerce_addons_params.currency_format_symbol,decimal:woocommerce_addons_params.currency_format_decimal_sep,thousand:woocommerce_addons_params.currency_format_thousand_sep,precision:woocommerce_addons_params.currency_format_num_decimals,format:woocommerce_addons_params.currency_format}),e=accounting.formatMoney(result.price_excluding_tax,{symbol:woocommerce_addons_params.currency_format_symbol,decimal:woocommerce_addons_params.currency_format_decimal_sep,thousand:woocommerce_addons_params.currency_format_thousand_sep,precision:woocommerce_addons_params.currency_format_num_decimals,format:woocommerce_addons_params.currency_format});w=w.replace("{price_including_tax}",d),w=w.replace("{price_excluding_tax}",e),y=y+"<dt>"+woocommerce_addons_params.i18n_grand_total+'</dt><dd><strong><span class="amount">'+f+"</span> "+w+" </strong></dd></dl>",t.html(y),o.trigger("updated_addons")}else y=y+"<dt>"+woocommerce_addons_params.i18n_grand_total+'</dt><dd><strong><span class="amount">'+f+"</span></strong></dd></dl>",t.html(y),o.trigger("updated_addons")},error:function(){y=y+"<dt>"+woocommerce_addons_params.i18n_grand_total+'</dt><dd><strong><span class="amount">'+f+"</span></strong></dd></dl>",t.html(y),o.trigger("updated_addons")}})}else t.empty(),o.trigger("updated_addons")}else t.empty(),o.trigger("updated_addons")}),a(this).find(".addon-custom, .addon-custom-textarea, .product-addon input, .product-addon textarea, .product-addon select, input.qty").change(),a(this).find(".variations select").change()},a("body").on("quick-view-displayed",function(){a(this).find(".cart:not(.cart_group)").each(function(){a(this).init_addon_totals()})}),a("body .component").on("wc-composite-component-loaded",function(){a(this).find(".cart").each(function(){a(this).init_addon_totals()})}),a("body").find(".cart:not(.cart_group)").each(function(){a(this).init_addon_totals()})});